---
title : "넷플릭스의 "
date : 2020-11-13
categories : 기술리뷰
tags :
- 추천알고리즘
- 기술리뷰
use_math : true
published : False
---
Learning a Personalized Homepage
넷플릭스의 화면은 개인마다 다르다. 이번 포스트에서는 넷플릭스가 어떻게 개인 맞춤형 화면을 설정하는지 알아보자. 다음 넷플릭스 기술 블로그 글을 참고했다.
[넷플릭스 아티클1](https://netflixtechblog.com/learning-a-personalized-homepage-aa8ec670359a)
[넷플릭스 아티클2](https://netflixtechblog.com/to-be-continued-helping-you-find-shows-to-continue-watching-on-7c0d8ee4dab6)

넷플릭스는 한 페이지에 표시할 수 있는 것보다 더 많은 영상 콘텐츠가 있고, 각 유저마다 고유한 관심사를 가지고 있다고 가정한다. 따라서 홈페이지는 개인의 관심사와 의도를 다루면서도 다른 콘텐츠를 탐색할 수 있도록 해야한다.

이러한 문제는 넷플릭스에만 국한된 것이 아니라 뉴스 사이트, 검색 엔진, 온라인 쇼핑몰에서도 해결하고자 한다. 이 사이트들의 공통점은 많은 항목 중에서 몇가지를 선택하여, 일관되고 탐색하기 쉬운 방식으로 제시해야한다. 물론 넷플릭스는 인터페이스 제약, 다른 미디어에 비해 영화나 TV가 소비되는 방식의 차이와 같은 고유한 측면도 있다.

현재 대부분의 기기에서 넷플릭스 홈페이지는 2차원 레이아웃으로 보여진다. 행은 같은 주제로 구성된 영상(영화나 TV 프로그램)로 구성되어 있다. 유저는 행에서 가로로 스크롤하여 동일 주제의 영상을 보거나, 세로로 스크롤하여 다른 주제의 영상을 볼 수 있다. 따라서 개인화의 핵심은 화면에 표시할 행을 선택하는 것이다. 여기에는 각 유저와 가장 관련이 있는 행을 선택하는 방법, 해당 행을 채우는 방법, 시청할 영상을 직관적으로 선택할 수 있도록 정렬하는 방법이 포함된다.

### Why Rows Anyway?
유저가 많은 영상을 쉽게 탐색할 수 있도록 행 단위로 구성한다. 한 행에 하나의 주제에 대한 영상을 배치하고, 각 행에 의미있는 이름을 붙여 유용한 순서로 행을 표시한다. 여러 행으로 나열된 영상 세트에 보고 싶은 내용이 포함될 가능성이 있는지 여부를 신속하게 결정할 수 있다. 더 깊이 들어가 동일한 주제의 더 많은 영상을 찾거나 건너 뛰고 다른 행을 볼 수 있다.

대표적으로 장르, 하위 장르, 출시 날짜와 같은 메타 데이터로 영상을 묶을 수 있다. 물론 연속된 영상 간의 관계는 메타 데이터에만 기인 할 필요는 없다. 협업 필터링 알고리즘처럼 행동 정보(ex. 시청할 가능성이 있는 영상, 친구가 시청한 영상)로 그룹을 만들 수 있다. 이렇게 다양한 방법으로 개인화된 영상 그룹을 제공할 수 있다. 넷플릭스는 지속적으로 새로운 방법으로 영상 그루핑을 시도하며 개인화된 홈페이지를 만들고 있다.

영상 그룹을 만든 후, 홈페이지를 구성할 수 있다. 유저에 대한 정보를 기반으로 유저와 관련이 있을 수 있는 후보 그룹을 찾는 것으로 시작한다. 예를 들면, 한 장르에서 이전에 시청한 영화와 같은 정보를 이용한다. 다음으로 각 그룹을 필터링하여 수위 등급과 같은 문제를 처리하거나 이전에 시청한 영상을 삭제한다. 필터링 후 행에 적합한 순위 알고리즘에 따라 각 그룹의 영상 순위를 매겨, 유저와 관련성이 높은 순서로 정렬한다. 이 행 후보 세트에서 행 선택 알고리즘을 적용하여 전체 페이지를 조합할 수 있다. 페이지가 구성되면 중복 제거와 같은 추가 필터링을 수행하여 반복되는 영상을 제거하고 행을 장치에 적합한 크기로 포맷한다.

### Page-level algorithmic challenge
알고리즘으로 개인화된 화면은 수천개의 영상에서 유저 프로필과 기기 당 하나의 페이지를 만드는 것을 의미한다. 여러 요소의 균형을 맞춰서 한 화면 공간을 구성해야한다. 넷플릭스는 유저들이 새로운 것을 발견할 수 있도록 돕는데 초점을 맞추고 있으며, 이를 발견이라고 한다. 추가적으로 프로그램의 다음 에피소드를 보거나 과거에 보았던 것을 다시 볼 수 있도록 한다. 유저의 취향에 맞는 영상을 정확하게 추천하면서도 유저의 관심사 범위를 포함할 수 있도록 다양해야 한다. 유저가 추천된 영상을 시청하거나 목록에 추가하거나 평가하는 것과 같이 반응하기를 바란다. 하지만 사람들이 자신의 홈페이지에 익숙해지고 최근에 추천한 영상을 쉽게 찾을 수 있도록 어느 정도의 안정성을 원한다. 마지막으로 검색 지향 행 사이에 "내 목록"과 같은 작업 지향 행을 배치할 수 있어야 한다.

각 장치에는 한번에 표시되는 영상의 수, 행의 수, 전체 페이지의 크기가 다르다. 따라서 페이지 생성 프로세스는 행 수, 행의 최소와 최대 길이, 페이지에서 보이는 부분의 크기와 같은 페이지를 생성에 대한 제약 조건을 알고 있어야 한다. 

페이지 생성에는 많은 제약이 있지만, 이 수준에서 추천 문제를 해결하면 새로운 솔루션이 열린다. 앞서 언급했듯이 추천 시스템에서는 다양한 항목을 선택하는 것이 중요하다. 그러나 추천 항목이 다른 사람의 현재 의도와 일치하지 않는 다른 항목과 혼합될 수 있으므로 다양한 순위를 탐색하는 것이 어려울 수 있다. 그러나 2차원 탐색 레이아웃을 제공함으로써 유저는 수직으로 스크롤하여 현재 의도와 일치하지 않는 전체 콘텐츠 그룹을 쉽게 건너뛴 다음 더 관련성이 높은 집합을 찾은 다음 가로로 스크롤하여 더 많은 추천 항목을 볼 수 있다. 이를 통해 전체 페이지에 표시되는 영상의 다양성을 유지하면서 일관되고 의미있는 개별 행을 선택할 수 있으므로 관련성과 다양성을 모두 고려할 수 있다.

### Building a page algorithmically
알고리즘으로 홈페이지를 구성하는 기본적인 방법은 규칙 기반 접근 방식이다. 여기에서 규칙은 페이지의 특정 위치에 들어갈 수 있는 행 유형을 모든 구성원에게 지시하는 템플릿을 정의한다. 예를 들어 규칙은 첫번째 행이 Continue Watching(있는 경우), Top Picks(있는 경우), Popular on Netflix, 5개의 개인화된 장르 행이 되도록 지정할 수 있다. 이 접근 방식의 유일한 개인화는 과거에 누군가 시청한 영상에 대한 "Because you watched <video>" 행을 포함하고 알려진 장르 선호도를 기반으로 하는 장르 행을 포함하는 등 개인화된 방식으로 후보 행을 선택한다. 각 유형 내에서 특정 행을 선택하기 위해 간단한 휴리스틱과 샘플링이 사용되었다. 모든 유저에 대해 행을 배치할 위치를 이해하기 위해 A/B 테스트를 사용하여 이 템플릿을 발전시켰다.

이 접근 방식은 도움이 되었지만 중요하다고 생각하는 많은 측면을 무시한다.: 행에 있는 동영상의 품질, 페이지의 다양성 정도, 특정 행 유형에 대한 유저의 친밀도, 각 동영상에 대해 표시할 수 있는 증거의 품질. 또한 새 행이 성공하려면 관련 영상을 적절한 순서로 포함할 뿐만 아니라 템플릿에 적절하게 배치해야 하므로 새로운 유형의 행을 추가하기가 어려웠다. 이로 인해 템플릿에 대한 규칙은 시간이 지남에 따라 커지고 다양한 행을 처리하기에는 너무 복잡해졌고 모든 행을 배치하는 방법은 유저 경험을 위한 지역적 최적화를 나타냈다.

이러한 문제를 해결하기 위해 행 순서를 개인화 할 수 있다. 간단한 방법은 순위 문제에서 행을 항목으로 처리하는 것이다. 이를 행-순위 접근(row-ranking approach)이라고 한다. 이 접근 방식의 경우 행에 대한 점수 매겨서 기존 권장 사항 또는 순위 학습 방식을 활용할 수 있다. 모든 후보 행에 독립적으로 적용하여 해당 기능별로 정렬한 다음 맨 위 행을 선택하여 페이지를 채운다. 행 공간이 상대적으로 클 수 있지만 이러한 유형의 접근 방식은 상대적으로 빠르며 합리적인 정확도를 얻을 수 있다. 그러나 이렇게하면 다양성에 대한 개념이 없기 때문에 하나의 관심사로 가득 찬 페이지를 보여준다.: 심야, 가족, 로맨틱, 액션 등

다양성을 추가하기위해 이미 시청한 동영상과의 관계 뿐만 아니라 행을 모두 고려해서 점수를 매긴다. 즉, 행-순위 방식(row-ranking approach)에서 단계적 방식(stage-wise approach)으로 전환하는 것이다. 이 경우 간단한 탐욕법(greedy approach)로 이 기능을 최대화하는 행을 사용할 다음 행으로 선택한 다음 해당 선택을 고려하여 다음 위치에 대한 모든 행에 대해 다시 점수를 매긴다. 함수에 따라 탐욕법은 최적의 페이지로 이어지지 않을 수도 있다. k-row lookahead와 함께 단계적 접근 방식을 사용하면 탐욕법보다 최적의 페이지를 만들 수 있지만 계산 비용이 증가한다. [submodular function maximization](https://dl.acm.org/doi/10.1145/1498759.1498766)를 기반으로 다양성을 탐욕스럽게 추가하는 방식을 사용할 수 있다.

그러나 고정된 수평선은 페이지 아래에 있는 더 나은 행을 채우는 기능을 제한할 수 있기 때문에 스테이지 별 알고리즘조차도 최적의 페이지를 생성한다고 보장할 수 없다. 따라서 전체 페이지 스코어링 기능을 정의하여 페이지 단위 접근 방식을 취할 수 있다면 페이지를 채우는데 적절하게 행과 영상을 선택하여 최적화 할 수 있다. 물론 페이지의 공간은 행의 공간보다 훨씬 크다. 페이지 레이아웃은 개별 공간에서 정의되기 때문에 전체 페이지의 품질을 정의하는 함수를 직접 최적화하는 것은 계산적으로 금지된 정수 프로그래밍 문제다.
이러한 접근 방식 중 하나로 페이지 최적화 문제를 풀 때 중복 제거, 필터링, 장치 별 제약과 같은 이전에 언급 한 다양한 제약 조건도 고려해야한다. 이러한 각 제약은 최적화 문제의 복잡성을 추가한다.
